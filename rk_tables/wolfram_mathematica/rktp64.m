(*----------------- Runge-Kutta Tsitouras-Papakostas 6(4) -----------------*)
(*--------------- SIAM J. Sci. Comput., 20 (1999)  2067-2088 --------------*)

c={0,4/27,2/9,3/7,11/16,10/13,1};
a={{0,0,0,0,0,0,0},
{4/27,0,0,0,0,0,0},
{1/18,1/6,0,0,0,0,0},
{66/343,-729/1372,1053/1372,0,0,0,0},
{13339/49152,-4617/16384,5427/53248,95207/159744,0,0,0},
{-6935/57122,23085/48334,33363360/273642941,972160/118442467,172687360/610434253,0,0},
{611/1891,-4617/7564,6041007/13176488,12708836/22100117,-35840000/62461621,6597591/7972456,0}};
b={131/1800,0,1121931/3902080,319333/1682928,262144/2477325,4084223/15177600,1891/25200}; (* 6th order formula *)
bb={2694253/26100360,0,83647323/535804360,691202281/1789061040,-1275547648/10565208225,2/5,1891/25200}; (* 4th order formula *)
bs={t-287/90*t^2+98/27*t^3-7387/5400*t^4,
0,
191241/60970*t^2-29727/6097*t^3+7907787/3902080*t^4,
195853/135720*t^2-3773/1404*t^3+36199877/25243920*t^4,
-268288/145725*t^2+16384/3015*t^3-5183488/1486395*t^4,
4084223/15177600*t^4,
1891/4200*t^2-1891/1260*t^3+1891/1680*t^4};  (*--- 4th order, C^0 interpolant at x_n+t*h_n ---*)

(*-------------------------------------------------------------------------*)

digits = 50;

FormatList[l_] := NumberForm[N[#, digits], {Infinity,digits}]& /@ (l //. {el___, 0} -> {el} /. 0->0.) // ToString//InputForm;

(*a //. { List[content___, 0] -> List[content]};*)

FormatList@a

FormatList@b

FormatList@bb

FormatList@c

Length[a]

bs

CoefficientList[bs, t]


FormatList@Table[Coefficient[bs[[i]], t, j-1], 
   {i,1,Length[bs]}, 
   {j, 1, Max[Length@#&/@CoefficientList[bs,t]] }]


