#pragma once

#include "../util/polynomial.hpp"
#include <array>

namespace diffurch {
struct dp54 {

  constexpr static size_t s = 7;
  constexpr static size_t order = 5;
  constexpr static size_t order_embedded = 4;
  constexpr static size_t order_interpolation = 4;

  constexpr static std::array<std::array<double, s - 1>, s> a{
      {{},
       {0.20000000000000000000000000000000000000000000000000},
       {0.07500000000000000000000000000000000000000000000000,
        0.22500000000000000000000000000000000000000000000000},
       {0.97777777777777777777777777777777777777777777777778,
        -3.73333333333333333333333333333333333333333333333330,
        3.55555555555555555555555555555555555555555555555560},
       {2.95259868922420362749580856576741350403901844231060,
        -11.59579332418838591678097850937357110196616369455900,
        9.82289285169943606157597927145252248132906569120560,
        -0.29080932784636488340192043895747599451303155006859},
       {2.84627525252525252525252525252525252525252525252530,
        10.75757575757575757575757575757575757575757575757600,
        8.90642271774347246045359252906422717743472460453590,
        0.27840909090909090909090909090909090909090909090909,
        -0.27353130360205831903945111492281303602058319039451},
       {0.09114583333333333333333333333333333333333333333333,
        0.00000000000000000000000000000000000000000000000000,
        0.44923629829290206648697214734950584007187780772686,
        0.65104166666666666666666666666666666666666666666667,
        -0.32237617924528301886792452830188679245283018867925,
        0.13095238095238095238095238095238095238095238095238}}};

  constexpr static std::array<double, s> c{
      {0.00000000000000000000000000000000000000000000000000,
       0.20000000000000000000000000000000000000000000000000,
       0.30000000000000000000000000000000000000000000000000,
       0.80000000000000000000000000000000000000000000000000,
       0.88888888888888888888888888888888888888888888888889,
       1.00000000000000000000000000000000000000000000000000,
       1.00000000000000000000000000000000000000000000000000}};

  constexpr static std::array<double, s> b{
      {0.09114583333333333333333333333333333333333333333333,
       0.00000000000000000000000000000000000000000000000000,
       0.44923629829290206648697214734950584007187780772686,
       0.65104166666666666666666666666666666666666666666667,
       -0.32237617924528301886792452830188679245283018867925,
       0.13095238095238095238095238095238095238095238095238}};

  constexpr static std::array<double, s> bb{
      {0.08991319444444444444444444444444444444444444444444,
       0.00000000000000000000000000000000000000000000000000,
       0.45348906858340820604971548367774782869122491764001,
       0.61406250000000000000000000000000000000000000000000,
       -0.27151238207547169811320754716981132075471698113208,
       0.08904761904761904761904761904761904761904761904762,
       0.02500000000000000000000000000000000000000000000000}};

  constexpr static std::array<Polynomial<5>, s> bs{
      {{0.00000000000000000000000000000000000000000000000000,
        1.00000000000000000000000000000000000000000000000000,
        -2.86053866903708863097943370885663105213518085381780,
        3.09957787870912092268605753792811855250234711279230,
        -1.16181058364030928576714728261967728193248499746470,
        0.01391720730161032739385678688152311489865207182347},
       {},
       {0.00000000000000000000000000000000000000000000000000,
        0.00000000000000000000000000000000000000000000000000,
        4.04714149964278557319049904942449527421302289187800,
        -6.34535404693892573505342403022818979479695679525830,
        2.79546508641400508297021164893042296731423395351700,
        -0.04801624082496285462031452077722260665842224240982},
       {0.00000000000000000000000000000000000000000000000000,
        0.00000000000000000000000000000000000000000000000000,
        7.84741007111265892938301126569893156405542561453250,
        -13.50816969460696101391505947117688990840374671710300,
        6.72931750920927857301441847859031845797454992394090,
        -0.41751621904830982181570360644569344695956215470417},
       {0.00000000000000000000000000000000000000000000000000,
        0.00000000000000000000000000000000000000000000000000,
        2.84194470158703464060417964659343605697434957168720,
        -7.54767586295938599838505349903387310042704029578820,
        4.95763672493125298061794541677800406766688093311860,
        -0.57428174280418464170499609263945381666702039769687},
       {0.00000000000000000000000000000000000000000000000000,
        0.00000000000000000000000000000000000000000000000000,
        2.39670292163108553124449083469142506413685252737370,
        -4.74272536284904180356196142354156484858415188009150,
        2.95010386556673177529521224777075926666250808282390,
        -0.47312904339639455059678927796823852983425634915370},
       {0.00000000000000000000000000000000000000000000000000,
        0.00000000000000000000000000000000000000000000000000,
        1.52360049411133393144135467348444915173617479911710,
        -4.32946547433983506636374840484767697183937753380880,
        3.08812946634566833840343278924200648847023067026640,
        -0.28226448611716720348103905787877866836702793557465}}};
};
} // namespace diffurch
