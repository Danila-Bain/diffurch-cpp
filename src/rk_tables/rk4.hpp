#pragma once

#include "../util/polynomial.hpp"
#include <array>

namespace diffurch {
struct rk4 {

  constexpr static size_t s = 4;
  constexpr static size_t order = 4;
  /*constexpr static size_t order_embedded = 0;*/
  constexpr static size_t order_interpolation = 3;

  constexpr static std::array<std::array<double, 3>, 4> a{
      {{}, {0.5}, {0.0, 0.5}, {0.0, 0.0, 1.0}}};

  constexpr static std::array<double, 4> c{{0.0, 0.5, 0.5, 1.0}};

  constexpr static std::array<double, 4> b{
      {0.16666666666666666666666666666666666666666666666667,
       0.33333333333333333333333333333333333333333333333333,
       0.33333333333333333333333333333333333333333333333333,
       0.16666666666666666666666666666666666666666666666667}};

  /*constexpr static std::array<double, 7> bb{};*/

  constexpr static std::array<Polynomial<3>, 4> bs{
      {{0.00000000000000000000000000000000000000000000000000,
        1.00000000000000000000000000000000000000000000000000,
        -1.50000000000000000000000000000000000000000000000000,
        0.66666666666666666666666666666666666666666666666667},
       {0.00000000000000000000000000000000000000000000000000,
        0.00000000000000000000000000000000000000000000000000,
        1.00000000000000000000000000000000000000000000000000,
        -0.66666666666666666666666666666666666666666666666667},
       {0.00000000000000000000000000000000000000000000000000,
        0.00000000000000000000000000000000000000000000000000,
        1.00000000000000000000000000000000000000000000000000,
        -0.66666666666666666666666666666666666666666666666667},
       {0.00000000000000000000000000000000000000000000000000,
        0.00000000000000000000000000000000000000000000000000,
        -0.50000000000000000000000000000000000000000000000000,
        0.66666666666666666666666666666666666666666666666667}}};
};

struct rk43 {

  constexpr static size_t s = 5;
  constexpr static size_t order = 4;
  constexpr static size_t order_embedded = 3;
  constexpr static size_t order_interpolation = 3;

  constexpr static std::array<std::array<double, s - 1>, s> a{
      {{},
       {0.5},
       {0.0, 0.5},
       {0.0, 0.0, 1.0},
       {5. / 32., 7. / 32., 13. / 32., -1. / 32.}}};

  constexpr static std::array<double, s> c{{0.0, 0.5, 0.5, 1.0, 0.75}};

  constexpr static std::array<double, s> b{
      {0.16666666666666666666666666666666666666666666666667,
       0.33333333333333333333333333333333333333333333333333,
       0.33333333333333333333333333333333333333333333333333,
       0.16666666666666666666666666666666666666666666666667}};

  constexpr static std::array<double, s> bb{
      {-1. / 2., 7. / 3., 7. / 3., 13. / 6., -16. / 3.}};

  constexpr static std::array<Polynomial<3>, s> bs{
      {{0.00000000000000000000000000000000000000000000000000,
        1.00000000000000000000000000000000000000000000000000,
        -1.50000000000000000000000000000000000000000000000000,
        0.66666666666666666666666666666666666666666666666667},
       {0.00000000000000000000000000000000000000000000000000,
        0.00000000000000000000000000000000000000000000000000,
        1.00000000000000000000000000000000000000000000000000,
        -0.66666666666666666666666666666666666666666666666667},
       {0.00000000000000000000000000000000000000000000000000,
        0.00000000000000000000000000000000000000000000000000,
        1.00000000000000000000000000000000000000000000000000,
        -0.66666666666666666666666666666666666666666666666667},
       {0.00000000000000000000000000000000000000000000000000,
        0.00000000000000000000000000000000000000000000000000,
        -0.50000000000000000000000000000000000000000000000000,
        0.66666666666666666666666666666666666666666666666667},
       {}}};
};
} // namespace diffurch
